---
title: "HW 08: More Data Wrangling"
author: "Dylan Klingeman"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

- Change "your name" in the YAML header above to your name.

- As usual, enter the examples in code chunks and run them, unless told otherwise.

## Chapter 5: Data transformation

Read [R4ds Chapter 5: Data transformation](https://r4ds.had.co.nz/transform.html), sections 5-7.

**You do not answer any of the questions this week.** Just read and run all of the examples as noted below. Pay attention to the code you enter for the examples. You will be applying the information in future assignments.

### Section 5.5: Add new variables with `mutate()`

Type and run all of the examples.

Pay careful attention to the useful creation functions in section 5.5.1. 

# 5.5.Add new variables with mutate()

```{r}
library(tidyverse)
library(nycflights13)
```

Loads tidyverse library + flights library for use in later code chunks.

```{r}
flights_sml <- select(flights, 
                      year:day, 
                      ends_with("delay"), 
                      distance, 
                      air_time
                      )
mutate(flights_sml, 
       gain = dep_delay - arr_delay, 
       speed = distance / air_time * 60
       )
```

This code chunk selects the flights data set usign some effficient code to pull the columns wanted. Afterwards the mutate() argument is used to add new columns in using data from previous columns. An example fo this is creating a column for speed, which we previously had to derive the data for manually in a past example. 

```{r}
mutate(flights_sml, 
       gain = dep_delay - arr_delay, 
```

This code chunk again shows the mutate() argument being used to create new columns in the flights data set. This time it creates a gain, hours, and gain_per_hour column. 

```{r}
transmute(flights, 
          gain = dep_delay - arr_delay, 
          hours = air_time / 60, 
          gain_per_hour = gain / hours
          )
```

This code chunk uses the transmute() argument with the flights dataset. This example shows how the transmute argument only shows the newly created columns. In this case we again create columns for gain, hours, and gain_per_hour. 

#

# 5.5.1 Useful creation functions

```{r}
transmute(flights, 
          dep_time, 
          hour = dep_time %/% 100, 
          minute = dep_time %% 100
)
```

This code chunk creates an hour and minute time in the flights dataset by using arithmetic operators. 

```{r}
(x <- 1:10)
lag(x)
lead(x)
```

This code chunk assigns a range tot he x variable and then applies a lead and lag function to it. THe lag() argument causes the variable to delay by 1, and the lead causes it to move ahead by 1. 

```{r}
y <-  c(1, 2, 2, NA, 3, 4)
min_rank(y)
min_rank(desc(y))
```

This code chunk assigns values to the variable y and then applies the min_rank() and min_rank(desc()) arguments. The min_rank argument orders the numbers from smallest to largest. The 'desc" in the min_rank causes this to descend, which reverses it. 

```{r}
row_number(y)
dense_rank(y)
percent_rank(y)
cume_dist(y)
```
This code chunk shows more ways to oragnize data within a variable. The row_number orders them by rows. Dense_rank orders them by value. Percent_rank orders the data and shows the percentage that it is from the maximum value. Cume_dist shows the proportion of each value compared to the maximum value. 

#

### Section 5.6: Grouped summaries with `summarise()`

Read and run all of the examples. Pay careful attention to the useful summary functions. Unless you really like baseball, skip the baseball part of 5.6.3.

```{r}
summarise(flights, delay = mean(dep_delay, na.rm = TRUE))
```

This code chunk applies the summarise() argument to the flights data set for the mean of the dep_delay column. This singles out this column and prints it's data. The sumamrise argument is typically used with others such as group_by() as shown in the next example. 

```{r}
by_day <- group_by(flights, year, month, day)
summarise(by_day, delay = mean(dep_delay, na.rm = TRUE))
```

This code chunk works similar to the one above, but uses the group_by function to combine columns to be used in summarise. This allows more of the data to be interpreted. Now we can see the mean for different days, months, and years. 

#

# 5.6.1 Combining multiple operations with the pipe

```{r}
by_dest <- group_by(flights, dest)
delay <- summarise(by_dest, 
                   count = n(), 
                   dist = mean(distance, na.rm =TRUE), 
                   delay = mean(arr_delay, na.rm = TRUE)
                   )
delay <- filter(delay, count > 20, dest != "HNL")

ggplot(data = delay, mapping = aes(x = dist, y = delay)) + 
  geom_point(aes(size = count), alpha = 1/3) + 
  geom_smooth(se = FALSE)
```

This code chunk creates a data set for a comparison of the mean distance and mean arrival delay from the flights dataset. The means created are then turned into a scatterplot graph. 


```{r}
delays <- flights %>% 
  group_by(dest) %>% 
  summarise(
    count = n(),
    dist = mean(distance, na.rm = TRUE),
    delay = mean(arr_delay, na.rm = TRUE)
  ) %>% 
  filter(count > 20, dest != "HNL")
```

This code chunk taken directly from the chapter does ntot work correctly. This code chunk is supposed to do the same as the above, but with less typing by utilizing the pipe function. 

#

# 5.6.2 Missing values

```{r}
flights %>% 
  group_by(year, month, day) %>% 
  summarise(mean = mean(dep_delay))
```

This code chunk shwos an example from above where we use the summarise and group by value to show the mean for dep_delay. In this example there is no "na.rm = TRUE", which is responsible for removing missing values. 

```{r}
not_cancelled <- flights %>% 
  filter(!is.na(dep_delay), !is.na(arr_delay))

not_cancelled %>% 
  group_by(year, month, day) %>% 
  summarise(mean = mean(dep_delay))
```

This code chunk creates a filter for flights that were not cancelled in the flights data set. Then the argument from above is applied to show the mean departure delay data. This will be used in later sections. 

#

# 5.6.3 Counts

```{r}
delays <- not_cancelled %>% 
  group_by(tailnum) %>% 
  summarise(
    delay = mean(arr_delay)
  )

ggplot(data = delays, mapping = aes(x = delay)) + 
  geom_freqpoly(bindwidth = 10)
```

This code chunk creates a data set for the delayed flights in the flights data set. The data is then grouped and sumamrised for the average. This is then put into a graph to show the frequency of delays and how often a specific time of delay will occurr. 

```{r}
delays <- not_canceled M
group_by(tailnum_ %>% 
           summarise(
             delay = mean(arr_delay, na.rm = TRUE), 
             n = n()
           )
         
ggplot(data = delays, mapping = aes(x = n, y = delay)) +
  geom_point(alpha = 1/10)
           ))
```

This code chunk again is an example of taking the mean along witha  group_by and summaries of the flights data set. This time a smaller sample set is shown to show how it can influence the data presented in a graph. 

```{r}
delays %>% 
  filter(n > 25) %>% 
  ggplot(mapping = aes(x = n, y = delay)) + 
    geom_point(alpha = 1/10)
```

This code chunk as presented does not work. This code chunk is supposed to show a similar graph to above, but as a point graph, with some of the data filtered. 

#

# 5.6.4 Usefual summary functions

```{r}

```



### Section 5.7: Grouped mutates (and filters)

Read and run all of the examples.